## 文件系统基本组成

<img src="/knowledge/assets/os/linux-dentry.png" width="750">

* 超级块：记录文件系统的整体信息，如文件系统的大小、空闲块的数量、磁盘块的数量、文件系统的类型等。
* 索引结点区：存放索引结点。
* 数据块区：存放文件数据块。

### 索引结点（inode）
### 目录项

## 文件的存储方式
### 连续空间存放
* 需要记录文件的起始地址和长度，类似于 inode。
* 有大量的外部碎片。
* 文件大小不易扩展。

### 链表的方式存放
* 不存在外部碎片。
* 文件大小易于扩展。
#### 隐式链表
* 文件头记录第一块和最后一块的位置。
* 每一块需要记录下一块的指针。
* 无法直接访问到后面的数据块。
* 稳定性差，中间丢失则后面都丢失。

#### 显式链表
* 在内存中设置一张表（FAT），记录下一块的地址。
* 相对于隐式链表，提高了检索速度。
* 但是不适用于大磁盘，因为需要记录下一块的地址，会占用大量的内存。

### 索引结点的方式存放
* 通过多级索引结点的方式，将文件的数据块地址存放在索引结点中。

## 空闲空间管理
### 空闲表
* 为所有空闲空间建立一张表，记录空闲空间的起始块号和块数。

### 空闲链表
* 将空闲块组织成链表，每个空闲块中存放下一个空闲块的地址。

### 位示图
* 为每个磁盘块建立一个位，0表示空闲，1表示占用。

## 链接
### 硬链接
* 新建一个目录项，其 inode 指向原文件的 inode。
* 当原文件删除时，硬链接仍然可以访问。
* 不能跨文件系统。
### 软链接
* 新建一个目录项，其内容为原文件的路径。
* 当原文件删除时，软链接无法访问。
* 可以跨文件系统。